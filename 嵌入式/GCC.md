## GCC

### GCC编译工具链（toolchain）

- gcc-core：即GCC编译器，用于完成预处理和编译过程，例如把C代码转换成汇编代码。

- Binutils ：除GCC编译器外的一系列小工具包括了链接器ld，汇编器as、目标文件格式查看器readelf等。

  - 常用工具

    - as：汇编器，把汇编语言代码转换为机器码（目标文件）。
    - ld：链接器，把编译生成的多个目标文件组织成最终的可执行程序文件。
    - readelf：可用于查看目标文件或可执行程序文件的信息。
    - nm ： 可用于查看目标文件中出现的符号。
    - objcopy： 可用于目标文件格式转换，如.bin 转换成 .elf 、.elf 转换成 .bin等。
    - objdump：可用于查看目标文件的信息，最主要的作用是反汇编。
    - size：可用于查看目标文件不同部分的尺寸和总尺寸，例如代码段大小、数据段大小、使用的静态内存、总大小等。

    > ldd工具查看动态文件的库依赖

- glibc：包含了主要的 C语言标准函数库，C语言中常常使用的打印函数printf、malloc函数就在glibc 库中。

### 基本语法

gcc [选项] 输入的文件名

常用选项：

- -o：小写字母“o”，指定生成的可执行文件的名字，不指定的话生成的可执行文件名为a.out。
- -E：只进行预处理，既不编译，也不汇编。
- -S：只编译，不汇编。
- -c：编译并汇编，但不进行链接。
- -g：生成的可执行文件带调试信息，方便使用gdb进行调试。
- -Ox：大写字母“O”加数字，设置程序的优化等级，如“-O0”“-O1” “-O2” “-O3”， 数字越大代码的优化等级越高，编译出来的程序一般会越小，但有可能会导致程序不正常运行。

![gcc编译过程](D:\gitRepo_my\cheney-du.github.io\嵌入式\gcchel006.jpg)

### 本地编译

编译器和目标程序都是相同架构的编译过程，被称为 **本地编译** 。

### 交叉编译

编译器和目标程序运行在不同架构的编译过程，被称为 **交叉编译**。

### 交叉编译器（Cross compiler

- arm-linux-gnueabihf-gcc：名称中的Linux表示目标应用程序是运行在Linux操作系统之上的，例如前面的hello.c程序。
- arm-none-eabi-gcc，名称中的none表示无操作系统，目标应用程序的运行环境是不带操作系统的，例如裸机代码、uboot、内核代码本身。

命名规则

arch [-os] [-(gnu)eabi(hf)] -gcc

| 字段 | 含义           |
| ---- | -------------- |
| arch | 目标芯片架构   |
| os   | 操作系统       |
| gnu  | C标准库类型    |
| eabi | 应用二进制接口 |
| hf   | 浮点模式       |